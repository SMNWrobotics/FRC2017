#tag Class
Protected Class t_game
Inherits Data.ActiveRecordBase
	#tag Event
		Sub BeforeSave()
		  if me.sGameUUID = "" then
		    me.sGameUUID = modGlobals.GetGUID
		  end
		End Sub
	#tag EndEvent


	#tag Method, Flags = &h0
		Shared Function FindByID(id as Integer) As Data.t_game
		  //Usage:
		  //dim t_game as Data.t_game = Data.t_game.FindByID( id )
		  dim s as string
		  s = "Select * from t_game WHERE match_id = " + str(id)
		  
		  dim rs as RecordSet = gDB.SQLSelect(s)
		  
		  if gdb.error then
		    System.debugLog gDB.ErrorMessage
		    return nil
		  end
		  if rs.RecordCount = 0 then return nil
		  
		  dim t_game as new Data.t_game
		  t_game.ReadRecord(rs)
		  return t_game
		  
		End Function
	#tag EndMethod

	#tag Method, Flags = &h0
		Shared Function List(sCriteria as string = "", sOrderBy as string = "") As Data.t_game()
		  //Usage:
		  // dim arot_game() as Data.t_game = Data.t_game.List("fieldName = somevalue", "fieldName")
		  
		  dim arot_game() as Data.t_game
		  dim s as string
		  
		  
		  s = "select  * From t_game "
		  if sCriteria <> "" then
		    s = s + " WHERE " + sCriteria
		  end
		  
		  
		  if sOrderBy.trim <> "" then 
		    s = s + " ORDER BY " + sOrderBy
		  end
		  
		  dim rs as RecordSet = gDB.SQLSelect(s)
		  If gdb.error then
		    break
		    System.debugLog gDB.ErrorMessage
		    return arot_game
		  end
		  
		  do until rs.EOF
		    dim oRecord as new Data.t_game
		    oRecord.ReadRecord(rs)
		    
		    arot_game.Append(oRecord)
		    rs.MoveNext
		  loop
		  
		  
		  
		  return arot_game
		End Function
	#tag EndMethod

	#tag Method, Flags = &h0
		Shared Function TeamForMatch(MatchKey as string, TeamKey as String) As Data.T_Game
		  dim s as string
		  
		  s = "Select * from t_game where MatchKey = " + MatchKey.SQLizeText + " AND TeamKey = " + teamKey.SQLizeText
		  
		  dim rs as RecordSet = gdb.SQLSelectRaiseOnError(s)
		  
		  if rs.RecordCount = 0 then
		    return nil
		  end
		  
		  dim oRecord as new Data.t_game
		  oRecord.ReadRecord(rs)
		  return oRecord
		End Function
	#tag EndMethod

	#tag Method, Flags = &h0
		Shared Function TeamFound(TeamKey as String) As boolean
		  dim s as string
		  
		  s = "Select Count(*) from t_game where TeamKey = " + teamKey.SQLizeText
		  
		  dim rs as RecordSet = gdb.SQLSelectRaiseOnError(s)
		  
		  return rs.IdxField(1).IntegerValue > 0
		End Function
	#tag EndMethod

	#tag Method, Flags = &h0
		Shared Function TeamFoundForMatch(MatchKey as string, TeamKey as String) As boolean
		  dim s as string
		  
		  s = "Select Count(*) from t_game where MatchKey = " + MatchKey.SQLizeText + " AND TeamKey = " + teamKey.SQLizeText
		  
		  dim rs as RecordSet = gdb.SQLSelectRaiseOnError(s)
		  
		  return rs.IdxField(1).IntegerValue > 0
		End Function
	#tag EndMethod


	#tag Property, Flags = &h0
		sGameUUID As String
	#tag EndProperty

	#tag Property, Flags = &h0
		sMatchKey As String
	#tag EndProperty

	#tag Property, Flags = &h0
		sscoutName As String
	#tag EndProperty

	#tag Property, Flags = &h0
		sScoutTeamKey As String
	#tag EndProperty

	#tag Property, Flags = &h0
		sTeamKey As String
	#tag EndProperty

	#tag Property, Flags = &h0
		sTeamNumber As String
	#tag EndProperty


	#tag ViewBehavior
		#tag ViewProperty
			Name="bAuto_Defense2Attempted"
			Group="Behavior"
			Type="boolean"
		#tag EndViewProperty
		#tag ViewProperty
			Name="bAuto_Defense2Succeeded"
			Group="Behavior"
			Type="boolean"
		#tag EndViewProperty
		#tag ViewProperty
			Name="bAuto_Defense3Attempted"
			Group="Behavior"
			Type="boolean"
		#tag EndViewProperty
		#tag ViewProperty
			Name="bAuto_Defense3Succeeded"
			Group="Behavior"
			Type="boolean"
		#tag EndViewProperty
		#tag ViewProperty
			Name="bAuto_Defense4Attempted"
			Group="Behavior"
			Type="boolean"
		#tag EndViewProperty
		#tag ViewProperty
			Name="bAuto_Defense4Succeeded"
			Group="Behavior"
			Type="boolean"
		#tag EndViewProperty
		#tag ViewProperty
			Name="bAuto_Defense5Attempted"
			Group="Behavior"
			Type="boolean"
		#tag EndViewProperty
		#tag ViewProperty
			Name="bAuto_Defense5Succeeded"
			Group="Behavior"
			Type="boolean"
		#tag EndViewProperty
		#tag ViewProperty
			Name="bAuto_DefenseReached"
			Group="Behavior"
			Type="boolean"
		#tag EndViewProperty
		#tag ViewProperty
			Name="bAuto_LowBarBreechAttempted"
			Group="Behavior"
			Type="boolean"
		#tag EndViewProperty
		#tag ViewProperty
			Name="bAuto_LowBarBreechSucceeded"
			Group="Behavior"
			Type="boolean"
		#tag EndViewProperty
		#tag ViewProperty
			Name="bChallengeAttempted"
			Group="Behavior"
			Type="boolean"
		#tag EndViewProperty
		#tag ViewProperty
			Name="bChallengeSucceeded"
			Group="Behavior"
			Type="boolean"
		#tag EndViewProperty
		#tag ViewProperty
			Name="bScaleAttempted"
			Group="Behavior"
			Type="Boolean"
		#tag EndViewProperty
		#tag ViewProperty
			Name="bScaleSuccessful"
			Group="Behavior"
			Type="Boolean"
		#tag EndViewProperty
		#tag ViewProperty
			Name="iAuto_HighShotAttempt"
			Group="Behavior"
			Type="Integer"
		#tag EndViewProperty
		#tag ViewProperty
			Name="iAuto_HighShotMade"
			Group="Behavior"
			Type="Integer"
		#tag EndViewProperty
		#tag ViewProperty
			Name="iAuto_LowShotAttempt"
			Group="Behavior"
			Type="Integer"
		#tag EndViewProperty
		#tag ViewProperty
			Name="iAuto_LowShotMade"
			Group="Behavior"
			Type="Integer"
		#tag EndViewProperty
		#tag ViewProperty
			Name="iDefense1Attempts"
			Group="Behavior"
			Type="Integer"
		#tag EndViewProperty
		#tag ViewProperty
			Name="iDefense1Made"
			Group="Behavior"
			Type="Integer"
		#tag EndViewProperty
		#tag ViewProperty
			Name="iDefense2Attempts"
			Group="Behavior"
			Type="Integer"
		#tag EndViewProperty
		#tag ViewProperty
			Name="iDefense2Made"
			Group="Behavior"
			Type="Integer"
		#tag EndViewProperty
		#tag ViewProperty
			Name="iDefense3Attempts"
			Group="Behavior"
			Type="Integer"
		#tag EndViewProperty
		#tag ViewProperty
			Name="iDefense3Made"
			Group="Behavior"
			Type="Integer"
		#tag EndViewProperty
		#tag ViewProperty
			Name="iDefense4Attempts"
			Group="Behavior"
			Type="Integer"
		#tag EndViewProperty
		#tag ViewProperty
			Name="iDefense4Made"
			Group="Behavior"
			Type="Integer"
		#tag EndViewProperty
		#tag ViewProperty
			Name="iDefense5Attempts"
			Group="Behavior"
			Type="Integer"
		#tag EndViewProperty
		#tag ViewProperty
			Name="iDefense5Made"
			Group="Behavior"
			Type="Integer"
		#tag EndViewProperty
		#tag ViewProperty
			Name="iDefenseType2_ID"
			Group="Behavior"
			Type="Integer"
		#tag EndViewProperty
		#tag ViewProperty
			Name="iDefenseType3_ID"
			Group="Behavior"
			Type="Integer"
		#tag EndViewProperty
		#tag ViewProperty
			Name="iDefenseType4_ID"
			Group="Behavior"
			Type="Integer"
		#tag EndViewProperty
		#tag ViewProperty
			Name="iDefenseType5_ID"
			Group="Behavior"
			Type="Integer"
		#tag EndViewProperty
		#tag ViewProperty
			Name="iGame_ID"
			Group="Behavior"
			Type="Integer"
		#tag EndViewProperty
		#tag ViewProperty
			Name="iHighShootAttempts"
			Group="Behavior"
			Type="Integer"
		#tag EndViewProperty
		#tag ViewProperty
			Name="iHighShootMade"
			Group="Behavior"
			Type="Integer"
		#tag EndViewProperty
		#tag ViewProperty
			Name="iLowShootAttempts"
			Group="Behavior"
			Type="Integer"
		#tag EndViewProperty
		#tag ViewProperty
			Name="iLowShootMade"
			Group="Behavior"
			Type="Integer"
		#tag EndViewProperty
		#tag ViewProperty
			Name="Index"
			Visible=true
			Group="ID"
			InitialValue="-2147483648"
			Type="Integer"
		#tag EndViewProperty
		#tag ViewProperty
			Name="Left"
			Visible=true
			Group="Position"
			InitialValue="0"
			Type="Integer"
		#tag EndViewProperty
		#tag ViewProperty
			Name="Name"
			Visible=true
			Group="ID"
			Type="String"
		#tag EndViewProperty
		#tag ViewProperty
			Name="sAutoNotes"
			Group="Behavior"
			Type="String"
			EditorType="MultiLineEditor"
		#tag EndViewProperty
		#tag ViewProperty
			Name="sGameUUID"
			Group="Behavior"
			Type="String"
			EditorType="MultiLineEditor"
		#tag EndViewProperty
		#tag ViewProperty
			Name="sMatchKey"
			Group="Behavior"
			Type="String"
			EditorType="MultiLineEditor"
		#tag EndViewProperty
		#tag ViewProperty
			Name="sOtherNotes"
			Group="Behavior"
			Type="String"
			EditorType="MultiLineEditor"
		#tag EndViewProperty
		#tag ViewProperty
			Name="sscoutName"
			Group="Behavior"
			Type="String"
			EditorType="MultiLineEditor"
		#tag EndViewProperty
		#tag ViewProperty
			Name="sScoutTeamKey"
			Group="Behavior"
			Type="String"
			EditorType="MultiLineEditor"
		#tag EndViewProperty
		#tag ViewProperty
			Name="sTeamKey"
			Group="Behavior"
			Type="String"
			EditorType="MultiLineEditor"
		#tag EndViewProperty
		#tag ViewProperty
			Name="sTeamNumber"
			Group="Behavior"
			Type="String"
			EditorType="MultiLineEditor"
		#tag EndViewProperty
		#tag ViewProperty
			Name="Super"
			Visible=true
			Group="ID"
			Type="String"
		#tag EndViewProperty
		#tag ViewProperty
			Name="Top"
			Visible=true
			Group="Position"
			InitialValue="0"
			Type="Integer"
		#tag EndViewProperty
	#tag EndViewBehavior
End Class
#tag EndClass
